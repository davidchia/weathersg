from pyspark.sql import SparkSession
spark = SparkSession.builder.appName("AggregatePosts").getOrCreate()
posts_df = spark.read.csv("s3://weathershield-emr-777/input/posts.csv", header=True)
agg_df = posts_df.groupBy("location").count()
agg_df.write.mode("overwrite").json("s3://weathershield-emr-777/output/agg_posts")
spark.stop()
